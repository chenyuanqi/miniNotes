/*
	@Name：jQuery fDialog v1.0
	@Date: 2015-06-03
	@Author：FonHen
	@Site：http://jquery.xixicms.com/fui/fdialog/
	@License：LGPL
*/
!function($){function hasOptions(a,b){var d,c=b.split(",");for(d=0;d<c.length;d++)if(a.hasOwnProperty(c[d]))return!0;return!1}function initBorder(a,b){var d,e,c={};""!=b.borderWidth&&(c.borderWidth=initWidthOrHeight(b.borderWidth)),""!=b.borderRadius&&(c.borderRadius=b.borderRadius),d=!1,(_ie>8||0==_ie)&&""!=b.borderOpacity&&(d=!0),""!=b.borderColor&&(d?(e=ColorToRGB(b.borderColor),e?e="rgba("+e.join(",")+","+b.borderOpacity+")":(d=!1,e=b.borderColor)):e=b.borderColor,c.borderColor=e),a.find(".fdialog-panel").css(c)}function initShade(a,b){var c={display:b.shade?"block":"none",opacity:b.shadeOpacity,backgroundColor:b.shadeColor,top:0};(_ie6||_ieMode>0&&7>_ieMode)&&(c.top=($(document).scrollTop()||$("body").scrollTop())+"px",c.position="absolute",c.height=($(window).height()||$("html").height())+"px",c.width=($(window).width()||$("html").width())+"px"),a.next(".fdialog-shade").css(c)}function initBtnOpitons(a){var d,e,f,b={text:"",cls:"",value:"",click:null},c=$.type(a);if("string"!=c&&"array"!=c&&(a=[]),"string"==c)for(d=a.split(","),a=[],e=0;e<d.length;e++)a[e]={text:d[e],value:e};for(e=0;e<a.length;e++)f=a[e],"string"==$.type(f)&&(f={text:f,value:e}),a[e]=$.extend({},b,f);return a}function initWidthOrHeight(a){return"number"==typeof a?a=a>0?a+"px":"auto":"string"==typeof a?a.lastIndexOf("px")==a.length-1?(a=parseInt(a.split("px")[0]),a=isNaN(a)?"auto":a+"px"):a.lastIndexOf("%")==a.length-1?(a=parseInt(a.split("%")[0]),a=isNaN(a)?"auto":a+"%"):(a=parseInt(a),a=isNaN(a)?"auto":a):a="auto",a}function ColorToRGB(a){if(a=a.toLowerCase(),hasOptions($.fDialog.color,a)&&(a=eval("$.fDialog.color."+a)),a=a.toUpperCase(),"#"!=a.substr(0,1))return!1;if(a=a.substring(1),6!=a.length)return!1;b=new Array;for(var x=0;3>x;x++)b[0]=a.substr(2*x,2),b[3]="0123456789ABCDEF",b[1]=b[0].substr(0,1),b[2]=b[0].substr(1,1),b[20+x]=16*b[3].indexOf(b[1])+b[3].indexOf(b[2]);return[b[20],b[21],b[22]]}function checkExtend(a,b,c,d){var f,e=!0;if("object"==typeof a)for(f in a)if("function"==typeof a[f]&&!a[f](b,c)){if(d)return!1;e=!1}return!0}var dialog,html,_index=0,_zindex=1e4,_ie=0,_ie6=!1,_ieMode=0,_timer=[];window.ActiveXObject&&(_ie=parseInt(navigator.appVersion.match(/msie [\d.]+;/gi)[0].match(/\d/gi)[0]),document.documentMode&&(_ieMode=parseInt(document.documentMode))),7>_ie&&_ie>0&&(_ie6=!0),(_ie6||_ieMode>0&&7>_ieMode)&&$(window).scroll(function(){$(".fui-dialog").each(function(){var a=dialog.data($(this));a.fixed&&(dialog.axis($(this)),a.shade&&initShade($(this),a))})}),$(window).resize(function(){$(".fui-dialog").each(function(){var a=dialog.data($(this));a.fixed&&(dialog.axis($(this)),(_ie6||_ieMode>0&&7>_ieMode)&&initShade($(this),a)),dialog.setHeight($(this))})}),$.fDialog=function(a,b,c){if("string"==typeof a){if("remove"===a)return dialog.remove(b,c),!0;if("show"===a)return dialog.show(b,c),!0;if("hide"===a)return dialog.hide(b,c),!0;a={content:a}}a=$.extend({},$.fDialog.defaults,a),""===a.id&&(a.id=_index++);var d=$("#fui-dialog-"+a.id);return 0==d.size()?d=dialog.init(a):"none"!=d.css("display")?dialog.reload(d,a):dialog.show(d,!0),d},$.fDialog.html=function(a,b){var c={};return"string"==$.type(a)?(c.content=a,c=$.extend({},c,b)):c=a,c=$.extend({},$.fDialog.html.defaults,c),c.module="html",$.fDialog(c)},$.fDialog.html.defaults={footer:!1,header:!1,borderWidth:"0px",shade:!1,closable:!1,time:0},$.fDialog.message=function(a,b,c,d){var e={};return"string"==$.type(a)?(e.content=a,"string"==$.type(b)?(e.icon=b,"number"==$.type(c)?(e.time=c,e=$.extend({},e,d)):e=$.extend({},e,c)):e=$.extend({},e,b)):e=a,e=$.extend({},$.fDialog.message.defaults,e),e.module="message",$.fDialog(e)},$.fDialog.message.defaults={module:"message",header:!1,footer:!1,w:"auto",height:"auto",shade:!0,fixed:!0,id:"message",closable:!1,time:0},$.fDialog.alert=function(a,b,c,d){var e={};return"string"==$.type(a)?(e.content=a,"string"==$.type(b)?(e.icon=b,"string"==$.type(c)?(e.title=c,e=$.extend({},e,d)):e=$.extend({},e,c)):e=$.extend({},e,b)):e=a,e=$.extend({},$.fDialog.alert.defaults,e),e.module="alert",$.fDialog(e)},$.fDialog.alert.defaults={title:"message",module:"alert",w:"400",height:"auto",shade:!0,fixed:!0,buttons:["OK"]},$.fDialog.module={alert:"alert",tip:"tip",html:"html",message:"message",string:"string",iframe:"iframe",ajax:"ajax"},$.fDialog.extend={remove:{},hide:{},show:{},init:{}},$.fDialog.color={red:"#FF0000",green:"#008000",black:"#000000",blue:"#0000FF",yellow:"#FFFF00",gray:"#808080",white:"#FFFFFF",brown:"#A52A2A",cyan:"#00FFFF"},$.fDialog.defaults={id:"",header:!0,footer:!0,title:"",titleCls:"",titleStyle:"",titleIcon:"",borderWidth:"",borderColor:"",borderOpacity:"",borderRadius:"",message:"",x:"center",y:"center",w:"auto",ieW:"300px",h:"auto",theme:"default",content:"",module:"string",icon:"",fixed:!0,buttons:[],buttonClick:function(){return!0},tools:[],toolClick:function(){return!0},closable:!0,closableClick:function(){return!0},beforeRemove:function(){return!0},afterRemove:function(){},beforeShow:function(){return!0},afterShow:function(){},beforeHide:function(){return!0},afterHide:function(){},afterAjax:function(){return!0},ajaxSuccess:function(){},ajaxError:function(){return!0},ajaxLoadingMsg:"Loading...",zIndex:0,shade:!1,shadeColor:"#ffffff",shadeOpacity:.7,shadeClick:function(){return!0},shadeEvent:!1,time:0,initEnd:function(){}},$.fn.fDialog=function(a,b){return this.each(function(){var c=this,d=dialog.data($(c));if(d)if("object"==typeof a)a.id=d.id,dialog.reload($(c),a);else if("string"==typeof a)switch(a){case"remove":dialog.remove($(this),b);break;case"hide":dialog.hide($(this),b);break;case"show":dialog.show($(this),b)}})},dialog={init:function(a){var b=this,c=html.init(a),d=$(c).appendTo("body").eq(0);return b.data(d,a),d.fDialog(a),b.event(d),a.initEnd(d),checkExtend($.fDialog.extend.init,d,a),d},reload:function(a,b){var e,c=this,d=c.options($.extend({},c.data(a),b));c.data(a,d),hasOptions(b,"time")&&(e=parseInt(d.time),e=isNaN(e)?0:e,clearTimeout(_timer[d.id]),e>0&&(_timer[d.id]=setTimeout(function(){a.fDialog("remove")},e))),hasOptions(b,"fixed")&&a.css("position",!d.fixed||_ie6||_ieMode>0&&7>_ieMode?"absolute":"fixed"),hasOptions(b,"closable")&&(a.find(".fdialog-tool-remove").css("display",d.closable?"":"none"),a.find(".fdialog-closable").css("display",!d.closable||"message"!=d.module&&"html"!=d.module?"none":"block")),hasOptions(b,"shade,shadeColor,shadeOpacity")&&initShade(a,d),hasOptions(b,"borderWidth,borderColor,borderRadius,borderOpacity")&&initBorder(a,d),hasOptions(b,"theme")&&a.attr("class","fui-dialog fdialog-theme-"+d.theme),hasOptions(b,"module")&&a.find(".fdialog-panel").attr("class","fdialog-panel fdialog-module-"+d.module),hasOptions(b,"w")&&a.css("width",d.w),hasOptions(b,"h")&&a.css("height",d.h),hasOptions(b,"zIndex")&&(a.css("zIndex",d.zIndex+1),a.next(".fdialog-shade").css("zIndex",d.zIndex)),hasOptions(b,"header")&&a.find(".fdialog-header").css("display",d.header?"block":"none"),hasOptions(b,"footer")&&a.find(".fdialog-footer").css("display",d.footer?"block":"none"),hasOptions(b,"title,titleCls,titleStyle,titleIcon")&&a.find(".fdialog-title").html(html.title(d)),hasOptions(b,"message")&&a.find(".fdialog-message").html(d.message),hasOptions(b,"content")&&c.setContent(a,d),"alert"!=d.module&&"tip"!=d.module||!hasOptions(b,"icon")||c.setContent(a,d),hasOptions(b,"buttons")&&a.find(".fdialog-buttons").html(html.buttons(d)),hasOptions(b,"tools")&&a.find(".fdialog-tools").html(html.tools(d)),hasOptions(b,"header,footer,content,w,h")&&c.setHeight(a),hasOptions(b,"x,y,w,h,footer,header")&&c.axis(a)},options:function(a){return""===a.id&&(a.id=_index++),a.zIndex||(a.zIndex=_zindex++),hasOptions(a,"tools")&&(a.tools=initBtnOpitons(a.tools)),hasOptions(a,"buttons")&&(a.buttons=initBtnOpitons(a.buttons)),hasOptions(a,"w")&&(a.w=initWidthOrHeight(a.w),"auto"==a.w&&(_ie>0&&8>_ie||_ieMode>0&&8>_ieMode)&&(hasOptions(a,"ieW")?(a.ieW=initWidthOrHeight(a.ieW),a.w="auto"==a.ieW?$.fDialog.defaults.ieW:a.ieW):a.w=$.fDialog.defaults.ieW)),hasOptions(a,"h")&&(a.h=initWidthOrHeight(a.h)),hasOptions(a,"module")&&(hasOptions($.fDialog.module,a.module)||(a.module="string")),a.ieMode=_ieMode,a.ie=_ie,a},data:function(a,b){var c=a.data("fui-dialog");return"object"==typeof b&&(c=$.extend({},c,b),a.data("fui-dialog",c)),c},setContent:function(a,b){var g,c=this,d=html.content(b),e=a.find(".fdialog-html"),f=a.find(".fdialog-loading");switch(e.find("iframe").size()>0&&e.find("iframe").attr("src","about:blank"),b.module){case"iframe":f.show(),e.html(d),g=e.find("iframe").attr("src",b.content),g.load(function(){f.hide()});break;case"ajax":f.html("Loading...").show(),e.load(b.content,function(d,e,g){return b.afterAjax(a,d,e,g)?("auto"==b.h&&c.axis(a),"success"==e||"notmodified"==e?(b.ajaxSuccess(a,d,e,g),f.html("").hide()):b.ajaxError(a,d,e,g)&&f.html("Error!"),void 0):!0});break;case"string":e.html(d);break;case"alert":e.html(d);break;case"message":e.html(d);break;default:e.html(d)}},setHeight:function(a){function k(a){return a.outerHeight(!0)-a.height()}var c,d,e,f,g,h,i,j,b=this.data(a);a.find(".fdialog-content").css("height","auto"),(_ie6||_ieMode>0&&7>_ieMode)&&(a.css("width",b.w),"string"==typeof b.w&&(c=b.w.split("%"),c.length>1&&(d=parseInt(c[0]),isNaN(d)||(e=parseInt(d*document.body.clientWidth/100)+"px",a.width(e)))),"string"==typeof b.h&&(c=b.h.split("%"),c.length>1&&(d=parseInt(c[0]),isNaN(d)||(f=parseInt(d*($(window).height()||$("html").height())/100)+"px",a.height(f))))),"auto"!==b.h&&(g=a.height(),h=a.find(".fdialog-header"),i=a.find(".fdialog-footer"),j=a.find(".fdialog-content"),f=g-("none"==h.css("display")?0:h.outerHeight(!0))-("none"==i.css("display")?0:i.outerHeight(!0))-k(a.children())-k(j),"100%"==b.h&&(f+=($(window).height()||document.body.clientHeight)-g),j.height(f))},axis:function(a,b){var e,f,g,h,i,c=this.data(a),d={left:"auto",top:"auto",right:"auto",bottom:"auto"};if(!c.fixed||_ie6||_ieMode>0&&7>_ieMode){switch(f=$(document).scrollTop()||$("body").scrollTop(),g=$(document).scrollLeft()||$("body").scrollLeft(),h=$(window).width()||document.body.clientWidth,i=$(window).height()||$("html").height(),c.x){case"center":e=(h-a.outerWidth(!0))/2+g,d.left=e>0?e+"px":"0px";break;case"left":d.left=g+"px";break;case"right":d.left=h-a.outerWidth(!0)+g+"px";break;default:e=parseInt(c.x),d.left=isNaN(e)?g+"px":0>e?h-a.outerWidth(!0)+g+e+"px":e+g+"px"}switch(c.y){case"center":e=(i-a.outerHeight(!0))/2+f,d.top=e>0?e+"px":"0px";break;case"top":d.top=f+"px";break;case"bottom":d.top=i-a.outerHeight(!0)+f+"px";break;default:e=parseInt(c.y),d.top=isNaN(e)?f+"px":0>e?i-a.outerHeight(!0)+f+e+"px":e+f+"px"}}else{switch(c.x){case"center":e=($(window).width()-a.outerWidth(!0))/2,d.left=e>0?e+"px":"0px";break;case"left":d.left="0px";break;case"right":d.right="0px";break;default:e=parseInt(c.x),isNaN(e)?d.left="0px":0>e?d.right=-e+"px":d.left=e+"px"}switch(c.y){case"center":e=($(window).height()-a.outerHeight(!0))/2,d.top=e>0?e+"px":"0px";break;case"top":d.top="0px";break;case"bottom":d.bottom="0px";break;default:e=parseInt(c.y),isNaN(e)?d.top="0px":0>e?d.bottom=-e+"px":d.top=e+"px"}}return b!==!1&&a.css(d),d},get:function(a){var e,f,c=$.type(a),d=null;if("string"==c){for(e=a.split(","),f=0;f<e.length;f++)e[f]="#fui-dialog-"+e[f];d=$(e.join(","))}else if("number"==c)d=$("#fui-dialog-"+a);else if("array"==c)for(e=[],f=0;f<a.length;f++)"string"==typeof a[f]&&e.push("#fui-dialog-"+a[f]),e.length>0&&(d=$(e.join(",")));else"object"==c&&a instanceof jQuery&&(d=a);return d},remove:function(a,b){function e(a,b){"iframe"==b.module&&a.find(".fdialog-html iframe").attr("src","about:blank"),a.next(".fdialog-shade").remove(),a.remove(),b.afterRemove()}var c=this,d=c.get(a);d.each(function(){var a=c.data($(this));a&&(b!==!0?a.beforeRemove($(this))===!0&&checkExtend($.fDialog.extend.remove,$(this),a,!0)&&e($(this),a):e($(this),a))})},show:function(a,b){function e(a,b){a.show(),b.shade===!0&&a.next(".fdialog-shade").show(),b.afterShow()}var c=this,d=c.get(a);d.each(function(){var a=c.data($(this));a&&(b!==!0?a.beforeShow($(this))===!0&&e($(this),a):e($(this),a))})},hide:function(a,b){function e(a,b){a.hide(),a.next(".fdialog-shade").hide(),b.afterHide()}var c=this,d=c.get(a);d.each(function(){var a=c.data($(this));a&&(b!==!0?a.beforeHide($(this))===!0&&e($(this),a):e($(this),a))})},event:function(a){var b=this;a.on("click",'.fdialog-button:not(".disabled")',function(){var c=b.data(a),d=$(this).index(),e=$(this).attr("value"),f=!1;f="function"==$.type(c.buttons[d].click)?c.buttons[d].click(e,this,d,a,c):c.buttonClick(e,this,d,a,c),$(this).addClass("checked").siblings().removeClass("checked"),f===!0&&a.fDialog("remove")}).on("mouseover mouseout",'.fdialog-button:not(".disabled")',function(a){"mouseover"==a.type?$(this).addClass("hover"):$(this).removeClass("hover")}),a.on("click",".fdialog-tool-remove,.fdialog-closable",function(){var c=b.data(a);c.closableClick(a)&&a.fDialog("remove")}).on("click",".fdialog-tool",function(){var c=b.data(a),d=$(this).index(),e=$(this).attr("value"),f=!1;f="function"==$.type(c.tools[d].click)?c.tools[d].click(e,this,d,a,c):c.toolClick(e,this,d,a,c)}),a.next(".fdialog-shade").click(function(){var c=b.data(a);c.shadeEvent===!0&&c.shadeClick(a)&&a.fDialog("remove")})}},html={init:function(a){var c,b=[];return b.push('<div class="fui-clearfix fdialog-header"><div class="fdialog-title"></div><div class="fdialog-tools"></div></div>'),b.push('<div class="fdialog-content" style="position:relative;"><div class="fui-clearfix fdialog-html"></div><div class="fdialog-loading" style="position:absolute;"></div></div>'),b.push('<div class="fui-clearfix fdialog-footer"><div class="fdialog-message"></div><div class="fdialog-buttons"></div></div>'),c='<div id="fui-dialog-'+a.id+'" class="fui-dialog" style="border:none; padding:0; margin:0; position:fixed; width:'+a.w+";height:"+a.h+';"><div class="fdialog-panel" style="position:relative;">'+b.join("")+'<div class="fdialog-closable" style="display:none; position:absolute;"></div></div></div><div id="fui-dialog-shade-'+a.id+'" class="fdialog-shade" style="width:100%; height:100%; padding:0; margin:0; border:0; background-color:#fff; opacity:0.5; position:fixed; top:0; left:0; display:none;"></div>'},title:function(a){var b=(""!==a.titleIcon?'<span class="fdialog-title-icon '+a.titleIcon+'"></span>':"")+'<span class="fdialog-title-text '+a.titleCls+'" style="'+a.titleStyle+'">'+a.title+"</span>";return b},content:function(a){var c,b="";switch(a.module){case"string":b=a.content;break;case"iframe":b='<iframe src="about:blank" width="100%" height="100%" frameborder="0" marginheight="0" marginwidth="0" scrolling="auto" style="display:block;"></iframe>';break;case"ajax":b='<div class="fdialog-html-ajax">Loaing...</div>';break;case"alert":c=a.content,c.indexOf("####")>0&&(strArr=c.split("####"),c="<h5>"+strArr[0]+"</h5><p>"+strArr[1]+"</p>"),b=(""!==a.icon?'<div class="fdialog-icon-box"><div class="fdialog-icon '+a.icon+'"></div></div>':"")+'<div class="fdialog-module-content">'+c+"</div>";break;case"message":b=(""!==a.icon?'<div class="fdialog-icon-box"><div class="fdialog-icon '+a.icon+'"></div></div>':"")+'<div class="fdialog-module-content">'+a.content+"</div>";break;default:b=a.content}return b},buttons:function(a){var b="";return $(a.buttons).each(function(a,c){""!=c.text&&(b+='<span class="fdialog-button '+c.cls+'" value="'+c.value+'">'+c.text+"</span>")}),b},tools:function(a){var b="";return $(a.tools).each(function(a,c){b+='<span title="'+c.text+'" class="fdialog-tool '+c.cls+'" value="'+c.value+'"></span>'}),b+='<span class="fdialog-tool-remove" style="'+(a.closable?"":"display:none;")+'"></span>'}}}(jQuery);